# Dart Data Class Plugin

[![CI Workflow](https://github.com/spideythewebhead/dart_data_class_plugin/actions/workflows/ci.yml/badge.svg)](https://github.com/spideythewebhead/dart_data_class_plugin/actions/workflows/ci.yml)

A way to create a dart data class without needing code generation.

### How it works

This plugin uses the [analyzer](https://pub.dev/packages/analyzer) system and [analyzer plugin](https://pub.dev/packages/analyzer_plugin) to get access on the source code and provide actions based on that.

### How to install

1. In your project's pubspec.yaml add on `dependencies` the following
   ```yaml
   dependencies:
     data_class_plugin:
       git:
         url: https://github.com/spideythewebhead/dart_data_class_plugin.git
         ref: main
   ```
1. Update your `analysis_options.yaml` (in case you don't have one, just create)

   Minimal analysis_options.yaml

   ```yaml
   include: package:lints/recommended.yaml

   # You need to register the plugin under analyzer>plugins
   analyzer:
     plugins:
       - data_class_plugin
   ```

1. Restart the analysis server

   #### VSCode

   1. Open the Command Palette (Windows/Linux: Ctrl+Shift+P, MacOS: ⌘+Shift+P)
   1. Type and select "Dart: Restart Analysis Server"

   #### IntelliJ

   1. Open Find Action (Windows/Linux: Ctrl+Shift+A, MacOS: ⌘+Shift+A)
   1. Type and select "Restart Dart Analysis Server"

### Generate the code you want!

#### Class

1. Create a simple class that contains `final public fields`.

   ```dart
   class User {
      final String id;
      final String username;
   }
   ```

1. Place the cursor on top of the `User` string in class declaration
1. Run code actions on your IDE
   1. VSCode: Control/Command + .
   1. Intellij: Alt/Command + Enter
1. You should a list with the following actions
   1. Generate shorthand constructor
      > Code generated by this action can be modified to an extent
      > You can remove the `required` keyword, add default values and mark the constructor as const
   1. Generate 'fromJson'
   1. Generate 'toJson'
   1. Generate 'copyWith'
   1. Generate 'hashCode' and 'equals'
   1. Generate 'toString

#### Enum

1. Create an enumeration with the last field closed by semicolon

   ```dart
   enum Category {
      science,
      sports;
   }
   ```

1. Place the cursor on top of the `Category` string in enum declaration
1. Run code actions on your IDE
   1. VSCode: Control/Command + .
   1. Intellij: Alt/Command + Enter
1. You should a list with the following actions
   1. Generate constructor
   1. Generate 'fromJson'
   1. Generate 'toJson'
   1. Generate 'toString'

> Enums can have an optional single field of primary type to be used in the fromJson or toJson transforms

```dart
enum Category {
   science(0),
   sports(1);

   final int value;
}
```

### Configuration

To create a custom configuration you need to add a file named `data_class_plugin_options.yaml` on the root folder of the project

```yaml
json:
  # Default naming convention for json keys
  key_name_convention: camel_case (default) | snake_case | snake_case | pascal_case

  # Maps naming conventions to globs
  # You can provide a map of all the conventions you need and then a list with all the globs
  # key_name_conventions glob match takes precedence over key_name_convention
  key_name_conventions:
    <camel_case | snake_case | snake_case | pascal_case>:
      - "a/glob/here"
      - "another/glob/here"
```

### Notes

If the generated method doesn't exist it will be placed in the end of the class (before `}`).
If the generated method exists, it will update in place the existing code with the new one.

### Development

In order to see your changes in the plugin you need to modify `tools/analyzer_plugin/pubspec.yaml` and add the following section

```yaml
dependency_overrides:
  data_class_plugin:
    path: /absolute/path/to/root_project
```

And restart the analysis server (in case that fails run pub_get.sh)
